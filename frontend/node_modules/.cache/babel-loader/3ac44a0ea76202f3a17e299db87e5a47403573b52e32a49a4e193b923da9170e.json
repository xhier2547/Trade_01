{"ast":null,"code":"class IQOptionAPI {\n  constructor(token) {\n    this.token = token;\n    this.ws = null;\n    this.isConnected = false;\n    this.candles = [];\n  }\n  connect() {\n    return new Promise((resolve, reject) => {\n      this.ws = new WebSocket(\"wss://iqoption.com/echo/websocket\"); // ✅ ใช้ WebSocket ของเบราว์เซอร์\n\n      this.ws.onopen = () => {\n        console.log(\"✅ Connected to IQ Option WebSocket\");\n        this.isConnected = true;\n        this.authenticate();\n        resolve();\n      };\n      this.ws.onmessage = message => {\n        const data = JSON.parse(message.data);\n        if (data.name === \"candles\") {\n          this.candles = data.msg.candles;\n        }\n      };\n      this.ws.onerror = error => {\n        console.error(\"❌ WebSocket Error:\", error);\n        reject(error);\n      };\n      this.ws.onclose = () => {\n        console.log(\"🔌 Disconnected from IQ Option WebSocket\");\n        this.isConnected = false;\n      };\n    });\n  }\n  authenticate() {\n    const authData = {\n      name: \"authenticate\",\n      msg: {\n        token: this.token\n      }\n    };\n    this.ws.send(JSON.stringify(authData));\n  }\n  subscribeCandles(asset, interval) {\n    const subscribeData = {\n      name: \"subscribeMessage\",\n      msg: {\n        name: \"candles\",\n        version: \"1.0\",\n        params: {\n          routingFilters: {\n            active_id: asset,\n            size: interval,\n            only_closed: false\n          }\n        }\n      }\n    };\n    this.ws.send(JSON.stringify(subscribeData));\n  }\n  getCandles() {\n    return this.candles;\n  }\n}\nexport default IQOptionAPI;","map":{"version":3,"names":["IQOptionAPI","constructor","token","ws","isConnected","candles","connect","Promise","resolve","reject","WebSocket","onopen","console","log","authenticate","onmessage","message","data","JSON","parse","name","msg","onerror","error","onclose","authData","send","stringify","subscribeCandles","asset","interval","subscribeData","version","params","routingFilters","active_id","size","only_closed","getCandles"],"sources":["C:/Users/wator/Documents/Ananto/trade/frontend/src/services/IQOptionAPI.js"],"sourcesContent":["class IQOptionAPI {\r\n    constructor(token) {\r\n      this.token = token;\r\n      this.ws = null;\r\n      this.isConnected = false;\r\n      this.candles = [];\r\n    }\r\n  \r\n    connect() {\r\n      return new Promise((resolve, reject) => {\r\n        this.ws = new WebSocket(\"wss://iqoption.com/echo/websocket\"); // ✅ ใช้ WebSocket ของเบราว์เซอร์\r\n  \r\n        this.ws.onopen = () => {\r\n          console.log(\"✅ Connected to IQ Option WebSocket\");\r\n          this.isConnected = true;\r\n          this.authenticate();\r\n          resolve();\r\n        };\r\n  \r\n        this.ws.onmessage = (message) => {\r\n          const data = JSON.parse(message.data);\r\n          if (data.name === \"candles\") {\r\n            this.candles = data.msg.candles;\r\n          }\r\n        };\r\n  \r\n        this.ws.onerror = (error) => {\r\n          console.error(\"❌ WebSocket Error:\", error);\r\n          reject(error);\r\n        };\r\n  \r\n        this.ws.onclose = () => {\r\n          console.log(\"🔌 Disconnected from IQ Option WebSocket\");\r\n          this.isConnected = false;\r\n        };\r\n      });\r\n    }\r\n  \r\n    authenticate() {\r\n      const authData = {\r\n        name: \"authenticate\",\r\n        msg: { token: this.token }\r\n      };\r\n      this.ws.send(JSON.stringify(authData));\r\n    }\r\n  \r\n    subscribeCandles(asset, interval) {\r\n      const subscribeData = {\r\n        name: \"subscribeMessage\",\r\n        msg: {\r\n          name: \"candles\",\r\n          version: \"1.0\",\r\n          params: {\r\n            routingFilters: { active_id: asset, size: interval, only_closed: false }\r\n          }\r\n        }\r\n      };\r\n      this.ws.send(JSON.stringify(subscribeData));\r\n    }\r\n  \r\n    getCandles() {\r\n      return this.candles;\r\n    }\r\n  }\r\n  \r\n  export default IQOptionAPI;\r\n  "],"mappings":"AAAA,MAAMA,WAAW,CAAC;EACdC,WAAWA,CAACC,KAAK,EAAE;IACjB,IAAI,CAACA,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,EAAE,GAAG,IAAI;IACd,IAAI,CAACC,WAAW,GAAG,KAAK;IACxB,IAAI,CAACC,OAAO,GAAG,EAAE;EACnB;EAEAC,OAAOA,CAAA,EAAG;IACR,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtC,IAAI,CAACN,EAAE,GAAG,IAAIO,SAAS,CAAC,mCAAmC,CAAC,CAAC,CAAC;;MAE9D,IAAI,CAACP,EAAE,CAACQ,MAAM,GAAG,MAAM;QACrBC,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC;QACjD,IAAI,CAACT,WAAW,GAAG,IAAI;QACvB,IAAI,CAACU,YAAY,CAAC,CAAC;QACnBN,OAAO,CAAC,CAAC;MACX,CAAC;MAED,IAAI,CAACL,EAAE,CAACY,SAAS,GAAIC,OAAO,IAAK;QAC/B,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACH,OAAO,CAACC,IAAI,CAAC;QACrC,IAAIA,IAAI,CAACG,IAAI,KAAK,SAAS,EAAE;UAC3B,IAAI,CAACf,OAAO,GAAGY,IAAI,CAACI,GAAG,CAAChB,OAAO;QACjC;MACF,CAAC;MAED,IAAI,CAACF,EAAE,CAACmB,OAAO,GAAIC,KAAK,IAAK;QAC3BX,OAAO,CAACW,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;QAC1Cd,MAAM,CAACc,KAAK,CAAC;MACf,CAAC;MAED,IAAI,CAACpB,EAAE,CAACqB,OAAO,GAAG,MAAM;QACtBZ,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAC;QACvD,IAAI,CAACT,WAAW,GAAG,KAAK;MAC1B,CAAC;IACH,CAAC,CAAC;EACJ;EAEAU,YAAYA,CAAA,EAAG;IACb,MAAMW,QAAQ,GAAG;MACfL,IAAI,EAAE,cAAc;MACpBC,GAAG,EAAE;QAAEnB,KAAK,EAAE,IAAI,CAACA;MAAM;IAC3B,CAAC;IACD,IAAI,CAACC,EAAE,CAACuB,IAAI,CAACR,IAAI,CAACS,SAAS,CAACF,QAAQ,CAAC,CAAC;EACxC;EAEAG,gBAAgBA,CAACC,KAAK,EAAEC,QAAQ,EAAE;IAChC,MAAMC,aAAa,GAAG;MACpBX,IAAI,EAAE,kBAAkB;MACxBC,GAAG,EAAE;QACHD,IAAI,EAAE,SAAS;QACfY,OAAO,EAAE,KAAK;QACdC,MAAM,EAAE;UACNC,cAAc,EAAE;YAAEC,SAAS,EAAEN,KAAK;YAAEO,IAAI,EAAEN,QAAQ;YAAEO,WAAW,EAAE;UAAM;QACzE;MACF;IACF,CAAC;IACD,IAAI,CAAClC,EAAE,CAACuB,IAAI,CAACR,IAAI,CAACS,SAAS,CAACI,aAAa,CAAC,CAAC;EAC7C;EAEAO,UAAUA,CAAA,EAAG;IACX,OAAO,IAAI,CAACjC,OAAO;EACrB;AACF;AAEA,eAAeL,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}